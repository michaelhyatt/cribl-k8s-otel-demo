{"name":"Traces from Lake","elements":[{"config":{"defaultValue":{"earliest":"-1h","latest":"now","timezone":"local"}},"id":"9p6ns71d8","inputId":"timerange","type":"input.timerange","layout":{"x":0,"y":0,"w":2,"h":2},"title":"Time Range"},{"config":{},"search":{"type":"inline","query":"|count ","earliest":"-1h","latest":"now","parentSearchId":"3rmvpsq9y"},"id":"bsrfkwyxc","layout":{"x":0,"y":0,"w":3,"h":1},"type":"counter.single","title":"amount of distinct traces"},{"config":{},"search":{"type":"inline","query":"dataset=\"otel_traces\" resource.attributes[\"service.name\"]=\"frontend\" name=\"POST /api/checkout\"\n// add duration field calculated from start and end times\n| extend duration = (end_time_unix_nano - start_time_unix_nano) / 1000000000 \n// aggregate by trace_id\n| summarize duration=max(duration) by trace_id \n// only show the top 10 (slowest) transactions\n","earliest":"-1h","latest":"now"},"id":"3rmvpsq9y","layout":{"x":0,"y":0,"w":4,"h":2},"type":"chart.column","title":"all traces","hidePanel":true},{"config":{"suffix":"s"},"search":{"type":"inline","query":"|summarize avg(duration)","earliest":"-1h","latest":"now","parentSearchId":"3rmvpsq9y"},"id":"jsl5z8i9x","layout":{"x":3,"y":0,"w":2,"h":1},"type":"counter.single","title":"average duration"},{"config":{"applyThreshold":true,"axis":{},"colorThresholds":{"thresholds":[{"color":"#45850B","threshold":0},{"color":"#EFDB23","threshold":0.2},{"color":"#B20000","threshold":0.5}]},"separator":true,"style":false},"search":{"type":"inline","query":" |summarize percentile(duration,99)","earliest":"-1h","latest":"now","parentSearchId":"3rmvpsq9y"},"id":"jroa6oxyb","layout":{"x":5,"y":0,"w":3,"h":1},"type":"counter.single","title":"99 percentile duration"},{"config":{"applyThreshold":true,"axis":{},"colorThresholds":{"thresholds":[{"color":"#45850B","threshold":1},{"color":"#EFDB23","threshold":1.5},{"color":"#B20000","threshold":2}]}},"search":{"type":"inline","query":"|summarize max(duration)","earliest":"-1h","latest":"now","parentSearchId":"3rmvpsq9y"},"id":"ydwveph9z","layout":{"x":8,"y":0,"w":3,"h":1},"type":"counter.single","title":"max duration"},{"config":{"customData":{"trellis":false,"seriesCount":3,"splitBy":"avg_duration"},"colorPalette":0,"axis":{}},"search":{"type":"inline","runMode":"lastRun","query":"dataset=\"otel_traces\" resource.attributes[\"service.name\"]=\"frontend\" name=\"POST /api/checkout\"\n// add duration field calculated from start and end times\n| extend duration = (end_time_unix_nano - start_time_unix_nano) / 1000000000 \n// aggregate by trace_id\n| summarize _time=findlatest(_time), duration=max(duration) by trace_id \n// only show the top 10 (slowest) transactions\n|timestats span=10m avg=avg(duration),  p95=percentile(duration,95), max=max(duration)","earliest":"-1h","latest":"now"},"id":"cmqk9kmuw","layout":{"x":0,"y":1,"w":12,"h":4},"type":"chart.column"},{"config":{"onClickAction":{"type":"Run a new search","search":"dataset=\"otel_traces\" trace_id=\"$value$\"\n| summarize count() by status_code=attributes[\"http.status_code\"]"},"axis":{}},"search":{"type":"inline","query":"// only show the top 10 (fastest) transactions\n| top 10 by duration asc ","earliest":"-1h","latest":"now","parentSearchId":"3rmvpsq9y"},"id":"0rtpxkile","layout":{"x":0,"y":5,"w":8,"h":4},"type":"chart.column","title":"top 10 fastest, and slowet click a bar to drilldown"},{"config":{"onClickAction":{"type":"Run a new search","search":"dataset=\"otel_*\" trace_id=\"$value$\"\n| send tee=true \"https://arturo-germicidal-rivka.ngrok-free.dev\""},"showRowNumbers":false,"colorPalette":0,"colorPaletteReversed":false,"customData":{"trellis":false,"connectNulls":"Leave gaps","stack":false},"xAxis":{"labelOrientation":0,"position":"Bottom"},"yAxis":{"position":"Left","scale":"Linear","splitLine":true},"legend":{"position":"Right","truncate":true}},"search":{"type":"inline","runMode":"lastRun","query":"| top 10 by duration asc | project trace_id, duration\n | extend duration = round(duration, 4)","earliest":"-1h","latest":"now","parentSearchId":"3rmvpsq9y"},"id":"38mual6o7-copy","layout":{"x":8,"y":5,"w":4,"h":4},"type":"list.table","title":"Click a fast trace_id to replay into Elastic"},{"config":{"onClickAction":{"type":"Run a new search","search":"dataset=\"otel_traces\" trace_id=\"$value$\"\n| summarize count() by status_code=attributes[\"http.status_code\"]"},"axis":{}},"search":{"type":"inline","query":"// only show the top 10 (slowest) transactions\n| top 10 by duration desc","earliest":"-1h","latest":"now","parentSearchId":"3rmvpsq9y"},"id":"swuocpubw","layout":{"x":0,"y":9,"w":8,"h":5},"type":"chart.column","title":"top 10 slowest traces - Click to drilldown"},{"config":{"onClickAction":{"type":"Run a new search","search":"dataset=\"otel_*\" trace_id=\"$value$\"\n| send tee=true \"https://arturo-germicidal-rivka.ngrok-free.dev\""},"showRowNumbers":false,"colorPalette":0,"colorPaletteReversed":false,"customData":{"trellis":false,"connectNulls":"Leave gaps","stack":false},"xAxis":{"labelOrientation":0,"position":"Bottom"},"yAxis":{"position":"Left","scale":"Linear","splitLine":true},"legend":{"position":"Right","truncate":true}},"search":{"type":"inline","query":"| top 10 by duration desc\n| project trace_id, duration\n| extend duration = round(duration, 2)","earliest":"-1h","latest":"now","parentSearchId":"3rmvpsq9y"},"id":"38mual6o7","layout":{"x":8,"y":9,"w":4,"h":4},"type":"list.table","title":"Click a slow trace_id to replay into Elastic"}],"createdBy":"oidc|CriblCorpOkta|00uqbwsz1bzTYiOhK4x7","modifiedBy":"oidc|CriblCorpOkta|00uqbwsz1bzTYiOhK4x7","modified":1761031468820,"created":1734856878526,"layout":{},"displayCreatedBy":" ","displayModifiedBy":" ","schedule":{"enabled":false,"cronSchedule":"0 0 * * *","tz":"UTC","keepLastN":2},"groups":{},"cacheTTLSeconds":600}